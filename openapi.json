{
  "openapi": "3.1.0",
  "info": {
    "title": "Moonshit Architect API v2",
    "version": "8.0.0",
    "description": "Streamlined AI DevOps API with 15 endpoints for file management, Git commits, builds, logs, and system monitoring."
  },
  "servers": [
    {
      "url": "https://gpt-site-live-78f2a81c6107.herokuapp.com",
      "description": "Production Server"
    }
  ],
  "paths": {
    "/file": {
      "post": {
        "operationId": "createOrUpdateFile",
        "summary": "Create or update a file",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "filename": { "type": "string" },
                  "content": { "type": "string" },
                  "base64": { "type": "boolean" }
                },
                "required": ["filename"]
              }
            }
          }
        },
        "responses": { "200": { "description": "File created/updated" } }
      },
      "get": {
        "operationId": "readFile",
        "summary": "Read a file",
        "parameters": [
          {
            "name": "filename",
            "in": "query",
            "schema": { "type": "string" },
            "required": true
          }
        ],
        "responses": { "200": { "description": "File content" } }
      },
      "delete": {
        "operationId": "deleteFile",
        "summary": "Delete a file",
        "parameters": [
          {
            "name": "filename",
            "in": "query",
            "schema": { "type": "string" },
            "required": true
          }
        ],
        "responses": { "200": { "description": "File deleted" } }
      }
    },
    "/files": {
      "get": {
        "operationId": "listFiles",
        "summary": "List files in /public",
        "parameters": [
          {
            "name": "filter",
            "in": "query",
            "schema": { "type": "string" }
          },
          {
            "name": "dir",
            "in": "query",
            "schema": { "type": "string" }
          }
        ],
        "responses": { "200": { "description": "File list" } }
      }
    },
    "/commit": {
      "post": {
        "operationId": "commitChanges",
        "summary": "Commit changes to GitHub",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "commit_message": { "type": "string" },
                  "dry_run": { "type": "boolean" }
                },
                "required": ["commit_message"]
              }
            }
          }
        },
        "responses": { "200": { "description": "Committed" } }
      }
    },
    "/build": {
      "post": {
        "operationId": "runBuildCommand",
        "summary": "Run shell command",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "command": { "type": "string" }
                },
                "required": ["command"]
              }
            }
          }
        },
        "responses": { "200": { "description": "Command output" } }
      }
    },
    "/run-python": {
      "post": {
        "operationId": "executePython",
        "summary": "Execute Python code",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "filename": { "type": "string" },
                  "code": { "type": "string" },
                  "timeout": { "type": "number" }
                },
                "required": ["filename", "code"]
              }
            }
          }
        },
        "responses": { "200": { "description": "Execution result" } }
      }
    },
    "/logs": {
      "get": {
        "operationId": "fetchLogs",
        "summary": "Fetch logs",
        "parameters": [
          {
            "name": "lines",
            "in": "query",
            "schema": { "type": "integer" }
          },
          {
            "name": "type",
            "in": "query",
            "schema": { "type": "string", "enum": ["commits", "system"] }
          },
          {
            "name": "search",
            "in": "query",
            "schema": { "type": "string" }
          }
        ],
        "responses": { "200": { "description": "Logs" } }
      }
    },
    "/backup": {
      "get": {
        "operationId": "downloadBackup",
        "summary": "Download backup ZIP",
        "responses": { "200": { "description": "ZIP file" } }
      }
    },
    "/env": {
      "get": {
        "operationId": "getEnvironmentVariables",
        "summary": "Get environment variables",
        "responses": { "200": { "description": "Env vars" } }
      },
      "post": {
        "operationId": "setEnvironmentVariables",
        "summary": "Set environment variables",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "additionalProperties": { "type": "string" }
              }
            }
          }
        },
        "responses": { "200": { "description": "Updated" } }
      }
    },
    "/status": {
      "get": {
        "operationId": "getSystemStatus",
        "summary": "System status",
        "responses": { "200": { "description": "Status info" } }
      }
    },
    "/diff": {
      "get": {
        "operationId": "getDiff",
        "summary": "Compare local vs GitHub",
        "responses": { "200": { "description": "Diff info" } }
      }
    },
    "/exec": {
      "post": {
        "operationId": "runSafeCommand",
        "summary": "Run safe shell command",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "properties": {
                  "command": { "type": "string" }
                },
                "required": ["command"]
              }
            }
          }
        },
        "responses": { "200": { "description": "Command output" } }
      }
    },
    "/health": {
      "get": {
        "operationId": "healthCheck",
        "summary": "Health check",
        "responses": { "200": { "description": "Healthy" }, "503": { "description": "Unhealthy" } }
      }
    },
    "/repo": {
      "get": {
        "operationId": "getLatestCommit",
        "summary": "Get latest commit info",
        "responses": { "200": { "description": "Commit info" } }
      },
      "post": {
        "operationId": "syncFromGitHub",
        "summary": "Sync from GitHub",
        "responses": { "200": { "description": "Synced" } }
      }
    },
    "/metrics": {
      "get": {
        "operationId": "getMetrics",
        "summary": "System metrics",
        "responses": { "200": { "description": "Metrics" } }
      }
    }
  }
}
